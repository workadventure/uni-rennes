{"version":3,"file":"main_blank_space-a3a20e2a.js","sources":["../../src/matrix/main_blank_space.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n\nimport { ActionMessage } from '@workadventure/iframe-api-typings';\nimport { ITiledMap } from '@workadventure/tiled-map-type-guard'\nimport { bootstrap } from \"./main\";\n\nlet map!: ITiledMap\nlet triggerMessage!: ActionMessage;\n\n// Waiting for the API to be ready\nWA.onInit().then(async() => {\n    bootstrap()\n\n    map = await WA.room.getTiledMap()\n\n    setExitPrompt()\n\n}).catch(e => console.error(e));\n\nfunction declarePrompt(layerName: string, url: string) {\n    WA.room.setProperty(\"ExitZones/\" + layerName, \"exitUrl\", undefined)\n    WA.room.onEnterLayer(\"ExitZones/\" + layerName).subscribe(() => {\n        triggerMessage = WA.ui.displayActionMessage({\n            message: \"Go to room ?\",\n            callback: () => {\n                WA.nav.goToRoom(url)\n            }\n        });\n    })\n    WA.room.onLeaveLayer(\"ExitZones/\" + layerName).subscribe(() => {\n        setTimeout(() => {\n            triggerMessage.remove();\n        }, 1000)\n    })\n}\n\nfunction setExitPrompt() {\n    for (let Group of map.layers)\n        if (Group.name === \"ExitZones\" && Group.type === \"group\" && Group?.layers != undefined) {\n            for (let Layer of Group.layers) {\n                if (Layer?.properties != undefined) {\n                    for (let property of Layer.properties) {\n                        if (property.name === \"exitUrl\" && property?.value != undefined && property.type === \"string\")\n                            declarePrompt(Layer.name, property.value)\n                    }\n                }\n            }\n        }\n}\n\nexport {};\n"],"names":["map","triggerMessage","bootstrap","setExitPrompt","e","declarePrompt","layerName","url","Group","Layer","property"],"mappings":"kEAMA,IAAIA,EACAC,EAGJ,GAAG,OAAA,EAAS,KAAK,SAAW,CACdC,IAEJF,EAAA,MAAM,GAAG,KAAK,YAAY,EAElBG,GAElB,CAAC,EAAE,MAAMC,GAAK,QAAQ,MAAMA,CAAC,CAAC,EAE9B,SAASC,EAAcC,EAAmBC,EAAa,CACnD,GAAG,KAAK,YAAY,aAAeD,EAAW,UAAW,MAAS,EAClE,GAAG,KAAK,aAAa,aAAeA,CAAS,EAAE,UAAU,IAAM,CAC1CL,EAAA,GAAG,GAAG,qBAAqB,CACxC,QAAS,eACT,SAAU,IAAM,CACT,GAAA,IAAI,SAASM,CAAG,CACvB,CAAA,CACH,CAAA,CACJ,EACD,GAAG,KAAK,aAAa,aAAeD,CAAS,EAAE,UAAU,IAAM,CAC3D,WAAW,IAAM,CACbL,EAAe,OAAO,GACvB,GAAI,CAAA,CACV,CACL,CAEA,SAASE,GAAgB,CACrB,QAASK,KAASR,EAAI,OACd,GAAAQ,EAAM,OAAS,aAAeA,EAAM,OAAS,UAAWA,GAAA,YAAAA,EAAO,SAAU,MAChE,QAAAC,KAASD,EAAM,OAChB,IAAAC,GAAA,YAAAA,EAAO,aAAc,KACZ,QAAAC,KAAYD,EAAM,WACnBC,EAAS,OAAS,YAAaA,GAAA,YAAAA,EAAU,QAAS,MAAaA,EAAS,OAAS,UACnEL,EAAAI,EAAM,KAAMC,EAAS,KAAK,EAKpE"}