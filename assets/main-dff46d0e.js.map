{"version":3,"file":"main-dff46d0e.js","sources":["../../src/main.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n\nimport { bootstrapExtra } from \"@workadventure/scripting-api-extra\";\n\nconsole.log('Script started successfully');\n\n(async () => {\n    await WA.onInit();\n    await WA.players.configureTracking({\n      players: true,\n      movement: false,\n    });\n    await WA.player.getPosition();\n})();\n\n// Waiting for the API to be ready\nWA.onInit().then(() => {\n    console.log('Scripting API ready');\n    console.log('Player tags: ',WA.player.tags)\n\n    const mapUrl = WA.room.mapURL\n    const root = mapUrl.substring(0, mapUrl.lastIndexOf(\"/\"))\n    console.log(\"root is: \", root);\n    let currentMapName = WA.room.mapURL;\n\n    if(WA.player.tags.includes(\"admin\")) {\n        WA.player.setOutlineColor(0, 119, 141);\n    }\n\n    WA.ui.actionBar.addButton({\n        id: 'home',\n        type: 'action',\n        imageSrc: root + '/../arrows-to-center.svg',\n        toolTip: \"M'envoyer Ã  l'accueil de Villejean\",\n        callback: () => {\n            console.log(\"Returning to starting point from \" + currentMapName);\n            // changes the url to homepage\n            if (currentMapName === \"accueil-villejean\") {\n                const x = 25 * 32;\n                const y = 7 * 32;\n                WA.player.moveTo(x, y);\n            } else {\n                WA.nav.goToRoom(\"https://mondevirtuel.univ-rennes2.fr/@/accueil-villejean#from-presidence\")\n            }\n        }\n    });\n\n    WA.ui.actionBar.addButton({\n        id: 'map-btn',\n        // @ts-ignore\n        type: 'action',\n        imageSrc: 'https://hugoaverty.github.io/map-overview/img/map.svg',\n        toolTip: 'Map overview',\n        callback: () => {\n            openMapOverview();\n        }\n    });\n\n    // The line below bootstraps the Scripting API Extra library that adds a number of advanced properties/features to WorkAdventure\n    bootstrapExtra().then(() => {\n        console.log('Scripting API Extra ready');\n\n        if(!WA.player.state.tutorialDone){\n            WA.ui.modal.openModal({\n                title: \"Tutorial\",\n                src: 'https://workadventure.github.io/scripting-api-extra/tutorialv1.html',\n                allow: \"fullscreen; clipboard-read; clipboard-write\",\n                allowApi: true,\n                position: \"right\",\n            });\n        }\n    }).catch(e => console.error(e));\n}).catch(e => console.error(e));\n\nconst openMapOverview = async() => {\n    WA.ui.modal.closeModal();\n    const pos = await WA.player.getPosition();\n    WA.ui.modal.openModal({\n        // TODO fix map overview projet\n        //src: \"https://hugoaverty.github.io/map-overview/index.html?x=\"+pos.x+\"&y=\"+pos.y+\"\",\n        src: \"https://menu.lgeorget.eu/?x=\"+pos.x+\"&y=\"+pos.y,\n        allow: \"fullscreen\",\n        title: \"Map Overview\",\n        allowApi: true,\n        position: \"center\",\n    });\n}\n\nexport {};\n"],"names":["mapUrl","root","currentMapName","openMapOverview","bootstrapExtra","e","pos"],"mappings":"uCAIA,QAAQ,IAAI,6BAA6B,GAExC,UACG,MAAM,GAAG,SACH,MAAA,GAAG,QAAQ,kBAAkB,CACjC,QAAS,GACT,SAAU,EAAA,CACX,EACK,MAAA,GAAG,OAAO,kBAIpB,GAAG,OAAA,EAAS,KAAK,IAAM,CACnB,QAAQ,IAAI,qBAAqB,EACjC,QAAQ,IAAI,gBAAgB,GAAG,OAAO,IAAI,EAEpC,MAAAA,EAAS,GAAG,KAAK,OACjBC,EAAOD,EAAO,UAAU,EAAGA,EAAO,YAAY,GAAG,CAAC,EAChD,QAAA,IAAI,YAAaC,CAAI,EACzB,IAAAC,EAAiB,GAAG,KAAK,OAE1B,GAAG,OAAO,KAAK,SAAS,OAAO,GAC9B,GAAG,OAAO,gBAAgB,EAAG,IAAK,GAAG,EAGtC,GAAA,GAAG,UAAU,UAAU,CACtB,GAAI,OACJ,KAAM,SACN,SAAUD,EAAO,2BACjB,QAAS,qCACT,SAAU,IAAM,CACJ,QAAA,IAAI,oCAAsCC,CAAc,EAE5DA,IAAmB,oBAGhB,GAAA,OAAO,OAAO,IAAG,GAAC,EAElB,GAAA,IAAI,SAAS,0EAA0E,CAElG,CAAA,CACH,EAEE,GAAA,GAAG,UAAU,UAAU,CACtB,GAAI,UAEJ,KAAM,SACN,SAAU,wDACV,QAAS,eACT,SAAU,IAAM,CACIC,GACpB,CAAA,CACH,EAGcC,EAAA,EAAE,KAAK,IAAM,CACxB,QAAQ,IAAI,2BAA2B,EAEnC,GAAG,OAAO,MAAM,cACb,GAAA,GAAG,MAAM,UAAU,CAClB,MAAO,WACP,IAAK,sEACL,MAAO,8CACP,SAAU,GACV,SAAU,OAAA,CACb,CACL,CACH,EAAE,SAAW,QAAQ,MAAMC,CAAC,CAAC,CAClC,CAAC,EAAE,MAAMA,GAAK,QAAQ,MAAMA,CAAC,CAAC,EAE9B,MAAMF,EAAkB,SAAW,CAC5B,GAAA,GAAG,MAAM,aACZ,MAAMG,EAAM,MAAM,GAAG,OAAO,YAAY,EACrC,GAAA,GAAG,MAAM,UAAU,CAGlB,IAAK,+BAA+BA,EAAI,EAAE,MAAMA,EAAI,EACpD,MAAO,aACP,MAAO,eACP,SAAU,GACV,SAAU,QAAA,CACb,CACL"}